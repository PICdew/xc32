2006-04-13  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-tc]
	* rtpxlite.c: Enable for __mips16.
	(_m32c0_mfc0, _m32c0_mtc0): Redefine macros.
	(_mips_mfc0, _mips_mtc0): Ditto.
	(_m32c0_mftc0, _m32c0_mttc0): Ditto.
	(mips32_jr_hb): Ditto.
	(_mips_atomic_update, _mips_atomic_cas): Ditto.  Remove
	functions.
	(rtpx_jr_hb): New wrapper function; use it throughout.
	(rtpx_mt_dmt, rtpx_mt_emt, rtpx_mt_dvpe, rtpx_mt_evpe): Ditto.
	(rtpx_mt_yield): Ditto.
	(rtpx_atomic_delay, rtpx_atomic_update, rtpx_atomic_cas): New
	functions.
	(rtpx_self): Update definition.
	(_pthread_init): Update prototype and definition.
	* rtpxliteasm.S: Enable for __mips16.
	* rtpxstub.c: Disable for __mips16.

2006-04-13  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-tc]
	* rtpxlite.c (pthread_cond_broadcast): Fix the second argument
	to mips_atomic_swap().

2006-04-07  Nigel Stephens  <nigel@mips.com>

	* fileio.c (_mon_write): New API used by libc "simple" console
	output. 

2006-03-28  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-tc]
	* mdilow.S: Stop unused TCs and switch to TC 0 if needed.

2006-02-23  Thiemo Seufer  <ths@mips.com>

	* fileio.c (_mon_putc, _mon_getc): New functions.

2006-02-14  Thiemo Seufer  <ths@mips.com>

	* fileio.c (sbrk, _sbrk): Split out _sbrk as a low-lwvel
	sbrk which avoids zeroing the allocated memory.

2005-12-22  Maciej W. Rozycki  <macro@mips.com>

	[mti-trivial]
	* rtpxlite.c (_pthread_init): Fix formatting.

2005-12-07  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-tc]
	* rtpxlite.c (pthread_setspecific): Calculate the index to
	access thread specific data correctly.
	(pthread_getspecific): Likewise.

2005-11-30  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* mdilow.S: Only enable VPE 1 if requested.
	* rtpxlite.c: Assign the last TC to VPE 0 if VPE 1 is disabled.
	* sdemdi32.ld: Default to VPE 1 disabled.
	* sdemdi32hi.ld: Likewise.
	* sdemdi64.ld: Likewise.
	* sdemdi64hi.ld: Likewise.

2005-11-21  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* rtpxlite.c (_pthread_init): Bind one TC more to VPE 0.

2005-11-18  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* rtpxlite.c (_pthread_init): Get the local TCBind, not a
	remote one.

2005-09-06  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* mdilow.S: Use the KSEG1 space for the VPE 1 startup stub.
	Use $s0 for accessing the exception handlers area throughout.

2005-08-26  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* mdilow.S: Correct a typo in a register operand.

2005-08-24  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* mdilow.S: Move VPE 1 startup stub to the end of the 4kB page
	of RAM containing exception handlers.

2005-08-24  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* sdemdi32hi.ld: For VPE 1 use the second 32MB of RAM.
	* sdemdi64hi.ld: Likewise.

2005-08-16  Maciej W. Rozycki  <macro@mips.com>

	[mti-trivial]
	* rtpxstub.c: New file, resurrecting stub pthreads function
	implementations that used to be in fileio.c, for pre-R2 CPUs.
	* Makefile.in (CFILES, OFILES): Update accordingly.

2005-08-12  Maciej W. Rozycki  <macro@mips.com>

	[mti-trivial]
	* rtpxliteasm.S: Fix formatting throughout.

2005-08-12  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* rtpxliteasm.S: Remove harmful ".set mips32".

2005-08-12  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* mdilow.S: Remove a useless check for "__mips16".

2005-08-12  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* rtpxliteasm.S: Exclude the whole code for architecture rev. 1.

2005-08-11  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* mdilow.S: Exclude TC initialization for architecture rev. 1.
	* rtpxlite.c: Likewise, but for the whole code.

2005-08-04  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* mdilow.S (__reset): Initialize caches on VPE 0 only.  Bind
	thread contexts to VPE 1 and higher and activate them.
	* rtpxlite.c (_pthread_init): Don't initialize thread contexts
	but on VPE 0.  Leave TCs to be bound to other VPEs alone.
	* sdemdi32hi.ld: New script with an alternate load address.
	* sdemdi64hi.ld: Likewise.
	* Makefile.in (SCRIPTS): Add the new scripts.

2005-08-04  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* rtpxlite.c (_pthread_init): Use mips32_jr_hb() to clear a
	TCHalt hazard.

2005-08-02  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* rtpxlite.c (rtpx_num_threads): Change type to "volatile
	unsigned int" as it's accessed with atomic primitives.

2005-08-02  Maciej W. Rozycki  <macro@mips.com>

	[mti-trivial]
	* mdilow.S: Fix formatting throughout.

2005-08-01  Maciej W. Rozycki  <macro@mips.com>

	[mti-dbg-vpe]
	* mdilow.S (XCPTBASE): New macro to support flexible exception
	vector base setup.
	(XCPTCOPY): Modify to rely on XCPTBASE.
	* sdemdi32.ld (_ebase): New symbol.
	* sdemdi64.ld (_ebase): Likewise.

2005-06-15  David Ung  <davidu@mips.com>

	[mti-dsp-24ke]
	* crt0.S: Define SR_MX and enable it.

2005-05-12  Nigel Stephens  <nigel@mips.com>

	[mti-sdemdi-memsize]
	* mdilow.S: Bump default stack size to 16MB.

2005-04-22  Chris Dearman  <chris@mips.com>

	[mti-sdemdi-pthreads]		
	* Makefile.in: Added rtpxlite.c and rtpxliteasm.S

	* fileio.c: Removed dummy pthreads support. Pthreads support is
	now in rtpxlite.c/rtpxliteasm.S

	* rtpxlite.c:
	* rtpxliteasm.S: Imported from SDE

2005-04-22  Nigel Stephens  <nigel@mips.com>

	[mti-sdemdi-memsize]
	* mdilow.S: Initialise stack pointer to zero to avoid garbage heap
	limit. Correctly calculate _end + 8M as default stack top.

2005-04-22  Nigel Stephens  <nigel@mips.com>

	[mti-sdemdi-memsize]
	* mdilow.S: Increase heap size to 8MB.
		
2005-03-11  David Ung  <davidu@mips.com>

	[mti-mips16e-startupcode]
	* crt0.S: Remove the use of __mips16_hard_float.

2005-02-23  David Ung  <davidu@mips.com>

	[mti-mips16e-startupcode]
	* crt0.S (_start): Enable Cp1 and initialise fpu if
	__mips16_hard_float is defined.

2005-02-03  Chris Dearman  <chris@mips.com>

	* fileio.c: Added dummy functions for nanosleep, sleep, getpid,
	kill. Added some missing pthread stubs for gdb.threads regression
	tests: pthread_self, pthread_join, pthread_attr_setscope,
	pthread_create, pthread_exit, pthread_cond_wait and pthread_cond_init.

2004-11-26  Nigel Stephens  <nigel@mips.com>

	* sdemdi32.ld: Change object formats from elf32-*mips to elf32-trad*mips.
	
	* sdemdi64.ld: Change object formats from elf32-n*mips to elf32-ntrad*mips.

2004-10-14  David Ung  <davidu@mips.com>

	* crt0.S: Use .set nomips16 to avoid compiling in mips16 mode.
	* m32cache.S: Ditto.
	* mdilow.S: ..
	* mdisyscall.S: ..

2004-10-05  Nigel Stephens  <nigel@mips.com>

	* sdemdi32.ld (GROUP): Add -lm.
	
	* sdemdi64.ld: Similarly.

2004-10-04  Nigel Stephens  <nigel@mips.com>

	* mdilow.S (_xcptframe): Ouput .sdeosabi section.

	* crt0.S: Clear bss using inline code, not a call to memset, since
	including memset breaks some regression tests.

	* Makefile.in (SCRIPTS): Fix so that dependencies work.

	* sdemdi32.ld (.sdeosabi): Added this new section to the script,
	so that we can tell gdb that whether this program uses "SDE"
	exception handling or not.
	* sdemdi64.ld: Similarly. 

2004-09-29  Nigel Stephens  <nigel@mips.com>

	* sdemdi32.ld (GROUP): Add -le to the list (the soft-float library).
	
	* sdemdi64.ld (GROUP): Similarly.

	* mdixcpt.h: Added local copy of exception stack frame header
	which lists the register fields by number not name, though add
	aliases for the common registers.

	* mdilow.S: Use "mdixcpt.h" instead of <mips/xcpt.h>
	(_xcpthandler): Rewritten to use save stack frame using explicit
	register numbers instead of software names - the software names
	change depending in the ABI.

	* m32cache.S: Make it work when compiled with -mabi=n32.
	(mips_scache_linesize): Add missing definition.

	* configure.ac: New autoconf file.

	* configure: Rebuilt.

	* Makefile.in: Updated to latest be compatible with latest
	autoconf, and to copy link scripts to build directory.

Sun Aug 17 16:14:28 2003  Nigel Stephens  <nigel@mips.com>

	* m32cache.S: Declare scache variables.
	(mips_init_cache): Don't bother using position-independent tricks,
	in this environment we're at a fixed location.

Wed Aug 13 15:09:57 2003  Nigel Stephens  <nigel@mips.com>

	* mdilow.S (_xcpthandler): Include a full exception stack frame
	builder, along with _xcpt_call trampoline which generates a
	"signal" and exception stackframe which gdb can recognise and
	climb out of. Allows us to do a post-mortem debug if a regression
	test fails.

	* mdisyscall.S: Added _mdi_profil() and _mdi_sighook()
	entrypoints. 

	* mdi.h: Added _mdi_profil() and _mdi_sighook() prototypes and
	opcodes. 

	* m32cache.S (mips_sync_icache): Added this either as alias for
	mips_clean_cache, or as new function using "synci" for MIPS32r2.

Fri Jul 11 06:56:46 2003  Nigel Stephens  <nigel@mips.com>

	* m32cache.S: Enable this code for -mips16e.

	* mdilow.S: Similarly.
	(XVECENT): Add final nop for branch delay slot.
	(__start): Round stack down to 8 byte boundary.
	(__CALL_DUMMY_ADDRESS): Removed.

	* crt0.S: Initialise fpa csr $31 to zero.
	(__CALL_DUMMY_ADDRESS): Added variable in writable memory.

Tue May 27 14:43:11 2003  Nigel Stephens  <nigel@mips.com>

	* Makefile: New directory containing SDE libc glue to interface to
	a target connected via GDB and MDI.

