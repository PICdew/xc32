# Override newlib settings in t-sde and set up for building
# against SDE header files and libraries.

#ifndef TARGET_SYSTEM_ROOT
#TARGET_SYSTEM_ROOT=$(build_tooldir)
#TARGET_SYSTEM_ROOT_DEFINE=-DTARGET_SYSTEM_ROOT=\"$(TARGET_SYSTEM_ROOT)\" \
#	-DTARGET_SYSTEM_ROOT_RELOCATABLE \
#	-DSTANDARD_INCLUDE_DIR=\"/include\"
#endif

# Default location for system headers, e.g. $(exec_prefix)/sde/include
# XXX this should now be found correctly via the TOOL_INCLUDE_DIR setting
#CROSS_SYSTEM_HEADER_DIR = $(build_tooldir)/include

# Location to search for local system header files when building multilibs etc
CROSS_SYSTEM_HEADER_DIR = $(objdir)/../$(target_noncanonical)/include

# Remove stdarg.h stddef.h from USER_H
USER_H = $(srcdir)/ginclude/float.h \
	 $(srcdir)/ginclude/iso646.h \
	 $(srcdir)/ginclude/stdbool.h \
	 $(srcdir)/ginclude/varargs.h \
	 $(srcdir)/unwind.h \
	 $(EXTRA_HEADERS)

# Don't run fixinclude or fixproto
STMP_FIXINC = stmp-sdefixinc
STMP_FIXPROTO =

# Don't build FPBIT and DPBIT, we'll be using the SDE soft-float library
FPBIT = 
DPBIT = 

# We don't want to build gcc multilibs for every host that we build
# a compiler for - there are too many and they take too long to build.
# So:
#   --enable-multilib (default)
#	Do libgcc multilib build.
#	Do libgcc install only when GCCMULTILIBS is set.
#   --disable-multilib
#	Don't do libgcc multilib build/install, unless overridden by
#	setting GCCMULTILIBS env var at build/install time.

ifdef GCCMULTILIBS
LIBGCC := stmp-multilib
INSTALL_LIBGCC := install-multilib
else
LIBGCC := $(shell \
    if [ $(enable_multilib) = yes ] ; then \
      echo stmp-multilib; \
    else \
      echo ""; \
    fi)
INSTALL_LIBGCC := 
endif

# But we must force compiler the compiler to support multilib configurations, 
# even though we may not be actually building the libraries.	

support_multilib=yes

stmp-sdefixinc: gsyslimits.h
	rm -rf include; mkdir include
	chmod a+rx include
	rm -f include/syslimits.h
	cp $(srcdir)/gsyslimits.h include/syslimits.h
	chmod a+r include/syslimits.h
	$(STAMP) stmp-sdefixinc
